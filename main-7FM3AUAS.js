import{$a as z,Aa as u,Ba as K,Bb as ot,D as O,Eb as nt,J as n,K as r,L as d,Ma as N,O as w,Oa as R,P as b,Pa as D,Q as g,Ra as j,S as m,T as x,Ta as _,Ua as G,Va as q,W as y,Ya as B,_a as H,ab as J,bb as Q,db as W,fb as X,gb as Y,ha as E,hb as Z,ib as $,jb as tt,l as f,oa as C,pa as P,q as h,qa as U,r as v,ra as A,s as M,sa as F,sb as et,t as l,ta as T,u as c,ua as L,v as S,wb as it,xa as k,y as I,ya as V,z as p}from"./chunk-RPGEHT5G.js";var rt=(i,o)=>u.retrieveKey()==""&&u.retrieveUrl()==""?F(i,["/login"]):!0;function gt(i,o){i&1&&(n(0,"div")(1,"h3"),m(2,"Attempting to login...."),r(),d(3,"mat-progress-bar",8),r())}function ut(i,o){if(i&1){let s=w();n(0,"div")(1,"mat-card",9)(2,"div",10)(3,"form",11),b("ngSubmit",function(){h(s);let t=g();return v(t.onSubmit(t.loginForm.value))}),n(4,"div",12)(5,"mat-form-field",13)(6,"mat-label"),m(7," Api Url "),r(),d(8,"input",14),r(),n(9,"mat-form-field",13)(10,"mat-label"),m(11," Api Access Key "),r(),n(12,"input",15),b("keyup",function(t){h(s);let a=g();return v(a.onKey(t))}),r(),n(13,"button",16),b("click",function(){h(s);let t=g();return v(t.hide=!t.hide)}),n(14,"mat-icon"),m(15),r()()(),n(16,"mat-error"),m(17),r()(),n(18,"div",17)(19,"button",18),m(20," Login "),r()()()()()()}if(i&2){let s=g();l(3),p("formGroup",s.loginForm),l(9),p("type",s.hide?"password":"text"),l(),I("aria-label","Hide password")("aria-pressed",s.hide),l(2),x(s.hide?"visibility_off":"visibility"),l(2),x(s.loginError),l(2),p("disabled",!s.loginForm.valid)}}var at=(()=>{let o=class o{constructor(e,t,a,pt,ct){this.router=e,this.fb=t,this.apiService=pt,this.cdr=ct,this.hide=!0,this.loggingIn=!1,this.loginUtil=u,this.title="Venus' Arch",this.subtitle="A web archive/delete filter for Hydrus",this.loginForm=this.fb.group({apiUrl:["",_.required],apiKey:["",_.required]}),this.message="",this.loginError="",this.logo="/assets/app-logos/app-logo.png",a.setTitle("Login | Venus' Arch")}ngAfterViewInit(){this.logo=this.determineLoginLogo(),this.cdr.detectChanges()}ngOnInit(){this.determineAuth()}determineAuth(){let e=this.loginUtil.retrieveKey(),t=this.loginUtil.retrieveUrl();e==""&&t==""||this.apiService.verifyAccess(t,e).subscribe({next:a=>{this.loggingIn=!0,setTimeout(()=>this.router.navigate(["/file-search"]),700)}})}login(){this.message="Trying to log in ..."}onKey(e){e.key==="Enter"&&this.loginForm.valid&&this.onSubmit(this.loginForm.value)}logout(){this.message="Successfully logged out"}determineLoginLogo(){let e="assets/app-logos/",t=["app-logo.png"],a=Math.floor(Math.random()*(t.length-1-0+1)+0);return e+t[a]}onSubmit(e){this.apiService.verifyAccess(e.apiUrl,e.apiKey).subscribe({next:t=>{this.loginUtil.addToStorage(e.apiUrl,e.apiKey),this.loggingIn=!0,setTimeout(()=>this.router.navigate(["/file-search"]),700)},error:t=>{this.loginError="Unable to login - Incorrect access, url doesn't exist, or service isn't up"}})}};o.\u0275fac=function(t){return new(t||o)(c(L),c(Q),c(A),c(nt),c(S))},o.\u0275cmp=f({type:o,selectors:[["app-login"]],standalone:!0,features:[y],decls:10,vars:4,consts:[[1,"grid-container"],[1,"grid-header"],[1,"logo-container"],[1,"app-logo",3,"src"],[1,"title-container"],[1,"login-subtitle"],[1,"grid-contents"],[4,"ngIf"],["mode","indeterminate",1,"progress-bar"],[1,"login-form-card"],[1,"form-box"],[1,"form",3,"formGroup","ngSubmit"],[1,"form-fields-box"],["appearance","outline",1,"form-fields"],["matInput","","id","apiUrl","formControlName","apiUrl","autofocus","","type","text","required",""],["matInput","","id","apiKey","formControlName","apiKey","required","",3,"type","keyup"],["mat-icon-button","","matSuffix","","type","button",1,"password-visibility",3,"click"],[1,"submit-container"],["mat-flat-button","","color","accent","type","submit",1,"submit-button",3,"disabled"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),d(3,"img",3),r(),n(4,"div",4)(5,"h3",5),m(6),r()()(),n(7,"div",6),O(8,gt,4,0,"div",7)(9,ut,21,7,"div",7),r()()),t&2&&(l(3),p("src",a.logo,M),l(3),x(a.subtitle),l(2),p("ngIf",a.loggingIn),l(),p("ngIf",!a.loggingIn))},dependencies:[C,E,ot,D,N,R,$,X,Y,Z,tt,et,it,W,B,j,G,q,J,H,z],styles:['.grid-container[_ngcontent-%COMP%]{display:grid;gap:10px;align-items:center;grid-template-areas:". gh ." ". gc ."}.grid-header[_ngcontent-%COMP%]{grid-area:gh;display:grid;grid-template-areas:" . l ." " . n ."}.grid-contents[_ngcontent-%COMP%]{grid-area:gc}.logo-container[_ngcontent-%COMP%]{grid-area:l;align-self:center;justify-self:center}.title-container[_ngcontent-%COMP%]{grid-area:n}.app-logo[_ngcontent-%COMP%]{grid-area:l;margin-bottom:15px;height:400px;width:auto}.form-box[_ngcontent-%COMP%]{margin:20px}.login-form-card[_ngcontent-%COMP%]{background-color:#005cb248;border:5px solid black}.form-fields-box[_ngcontent-%COMP%]{margin:25px;display:block}.form-fields[_ngcontent-%COMP%]{width:100%}.progress-bar[_ngcontent-%COMP%]{width:30vw}.password-visibility[_ngcontent-%COMP%]{color:#f5f5f5}h1[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{font-variant:small-caps}.login-title[_ngcontent-%COMP%]{font-size:55px;text-align:center}.login-subtitle[_ngcontent-%COMP%]{font-size:35px;text-align:center}']});let i=o;return i})();var lt=[{path:"",canActivate:[rt],loadChildren:()=>import("./chunk-ICGZIS6P.js").then(i=>i.HOME_ROUTES)},{path:"login",component:at},{path:"**",redirectTo:"",pathMatch:"full"}];var ft={scrollPositionRestoration:"top",anchorScrolling:"enabled"},Gt=V(ft),st={providers:[k(lt),K(),P()]};var mt=(()=>{let o=class o{constructor(){this.title="venus-arch"}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=f({type:o,selectors:[["app-root"]],standalone:!0,features:[y],decls:2,vars:0,consts:[[1,"main-container"]],template:function(t,a){t&1&&(n(0,"div",0),d(1,"router-outlet"),r())},dependencies:[C,T],styles:[".main-container[_ngcontent-%COMP%]{margin:15px}"]});let i=o;return i})();U(mt,st).catch(i=>console.error(i));
